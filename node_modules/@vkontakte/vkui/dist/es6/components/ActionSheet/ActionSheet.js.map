{"version":3,"sources":["../../../../src/components/ActionSheet/ActionSheet.tsx"],"names":["React","Children","Component","PopoutWrapper","getClassName","classNames","transitionEvent","withInsets","withPlatform","isNumeric","ANDROID","IOS","ActionSheet","props","closing","setState","waitTransitionFinish","onClose","action","autoclose","event","persist","e","stopPropagation","index","childrenArray","toArray","children","lastElement","length","mode","elRef","createRef","eventHandler","supported","current","removeEventListener","name","addEventListener","clearTimeout","transitionFinishTimeout","setTimeout","platform","className","header","text","style","insets","restProps","state","map","child","arr","cloneElement","onClick","onItemClick","bottom","marginBottom","isLast","isItemLast"],"mappings":"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","sourcesContent":["import React, { Children, Component, HTMLAttributes, ReactElement } from 'react';\nimport PopoutWrapper from '../PopoutWrapper/PopoutWrapper';\nimport getClassName from '../../helpers/getClassName';\nimport classNames from '../../lib/classNames';\nimport { transitionEvent } from '../../lib/supportEvents';\nimport withInsets from '../../hoc/withInsets';\nimport withPlatform from '../../hoc/withPlatform';\nimport { isNumeric } from '../../lib/utils';\nimport { HasInsets, HasPlatform } from '../../types';\nimport { ANDROID, IOS } from '../../lib/platform';\n\nexport interface ActionSheetProps extends HTMLAttributes<HTMLDivElement>, HasPlatform, HasInsets {\n  /**\n   * iOS only\n   */\n  header?: React.ReactNode;\n  /**\n   * iOS only\n   */\n  text?: React.ReactNode;\n  onClose(): void;\n}\n\nexport interface ActionSheetState {\n  closing: boolean;\n}\n\nexport type CloseCallback = () => void;\n\nexport type ClickHandler = (event: React.MouseEvent<HTMLDivElement>) => void;\n\nexport type ActionType = (event: React.MouseEvent) => void;\n\nexport type ItemClickHandler = (action: ActionType, autoclose: boolean) => (event: React.MouseEvent) => void;\n\nexport type AnimationEndCallback = (e?: AnimationEvent) => void;\n\nexport type IsItemLast = (index: number) => boolean;\n\nclass ActionSheet extends Component<ActionSheetProps, ActionSheetState> {\n  constructor(props: ActionSheetProps) {\n    super(props);\n    this.elRef = React.createRef();\n  }\n\n  state: ActionSheetState = {\n    closing: false,\n  };\n\n  elRef: React.RefObject<HTMLDivElement>;\n\n  private transitionFinishTimeout: ReturnType<typeof setTimeout>;\n\n  onClose: CloseCallback = () => {\n    this.setState({ closing: true });\n    this.waitTransitionFinish(this.props.onClose);\n  };\n\n  onItemClick: ItemClickHandler = (action: ActionType, autoclose: boolean) => (event: React.MouseEvent) => {\n    event.persist();\n\n    if (autoclose) {\n      this.setState({ closing: true });\n      this.waitTransitionFinish(() => {\n        autoclose && this.props.onClose();\n        action && action(event);\n      });\n    } else {\n      action && action(event);\n    }\n  };\n\n  stopPropagation: ClickHandler = (e: React.MouseEvent<HTMLDivElement>) => e.stopPropagation();\n\n  waitTransitionFinish(eventHandler: AnimationEndCallback) {\n    if (transitionEvent.supported) {\n      this.elRef.current.removeEventListener(transitionEvent.name, eventHandler);\n      this.elRef.current.addEventListener(transitionEvent.name, eventHandler);\n    } else {\n      clearTimeout(this.transitionFinishTimeout);\n      this.transitionFinishTimeout = setTimeout(eventHandler, this.props.platform === ANDROID ? 200 : 300);\n    }\n  }\n\n  isItemLast: IsItemLast = (index: number) => {\n    const childrenArray = Children.toArray(this.props.children);\n    const lastElement = childrenArray[childrenArray.length - 1] as ReactElement;\n\n    if (index === childrenArray.length - 1) {\n      return true;\n    } else if (index === childrenArray.length - 2 && lastElement.props.mode === 'cancel') {\n      return true;\n    }\n\n    return false;\n  };\n\n  render() {\n    const { children, className, header, text, style, insets, platform, ...restProps } = this.props;\n\n    return (\n      <PopoutWrapper\n        closing={this.state.closing}\n        alignY=\"bottom\"\n        className={className}\n        style={style}\n        onClick={this.onClose}\n      >\n        <div\n          {...restProps}\n          ref={this.elRef}\n          onClick={this.stopPropagation}\n          className={classNames(getClassName('ActionSheet', platform), {\n            'ActionSheet--closing': this.state.closing,\n          })}\n        >\n          {platform === IOS &&\n          <header className=\"ActionSheet__header\">\n            {header && <div className=\"ActionSheet__title\">{header}</div>}\n            {text && <div className=\"ActionSheet__text\">{text}</div>}\n          </header>\n          }\n          {Children.toArray(children).map((child: React.ReactElement, index: number, arr: []) =>\n            child && React.cloneElement(child, {\n              onClick: this.onItemClick(child.props.onClick, child.props.autoclose),\n              style: index === arr.length - 1 && isNumeric(insets.bottom) ? { marginBottom: insets.bottom } : null,\n              isLast: this.isItemLast(index),\n            }),\n          )}\n        </div>\n      </PopoutWrapper>\n    );\n  }\n}\n\nexport default withPlatform(withInsets(ActionSheet));\n"],"file":"ActionSheet.js"}