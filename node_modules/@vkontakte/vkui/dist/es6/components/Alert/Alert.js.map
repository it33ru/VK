{"version":3,"sources":["../../../../src/components/Alert/Alert.tsx"],"names":["React","Component","Tappable","PopoutWrapper","getClassName","classNames","transitionEvent","ANDROID","withPlatform","Alert","props","item","action","autoclose","setState","closing","waitTransitionFinish","e","propertyName","onClose","stopPropagation","element","createRef","state","eventHandler","supported","current","removeEventListener","name","addEventListener","clearTimeout","transitionFinishTimeout","setTimeout","bind","platform","actions","actionsLayout","children","className","style","restProps","map","i","mode","onItemClick","__html","title"],"mappings":"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","sourcesContent":["import React, { Component, HTMLAttributes, MouseEventHandler, SyntheticEvent } from 'react';\nimport Tappable from '../Tappable/Tappable';\nimport PopoutWrapper from '../PopoutWrapper/PopoutWrapper';\nimport getClassName from '../../helpers/getClassName';\nimport classNames from '../../lib/classNames';\nimport { transitionEvent } from '../../lib/supportEvents';\nimport { ANDROID } from '../../lib/platform';\nimport { HasPlatform } from '../../types';\nimport withPlatform from '../../hoc/withPlatform';\n\nexport interface AlertActionInterface {\n  title: string;\n  action?(): void;\n  autoclose?: boolean;\n  mode: 'cancel' | 'destructive' | 'default';\n}\n\nexport interface AlertProps extends HTMLAttributes<HTMLElement>, HasPlatform {\n  actionsLayout?: 'vertical' | 'horizontal';\n  actions?: AlertActionInterface[];\n  onClose?(): void;\n}\n\nexport interface AlertState {\n  closing: boolean;\n}\n\ntype TransitionEndHandler = (e?: TransitionEvent) => void;\n\ntype ItemClickHander = (item: AlertActionInterface) => () => void;\n\nclass Alert extends Component<AlertProps, AlertState> {\n  constructor(props: AlertProps) {\n    super(props);\n    this.element = React.createRef();\n    this.state = {\n      closing: false,\n    };\n  }\n\n  element: React.RefObject<HTMLDivElement>;\n\n  private transitionFinishTimeout: ReturnType<typeof setTimeout>;\n\n  static defaultProps: AlertProps = {\n    actionsLayout: 'horizontal',\n    actions: [],\n  };\n\n  onItemClick: ItemClickHander = (item: AlertActionInterface) => () => {\n    const { action, autoclose } = item;\n\n    if (autoclose) {\n      this.setState({ closing: true });\n      this.waitTransitionFinish((e?: TransitionEvent) => {\n        if (!e || e.propertyName === 'opacity') {\n          autoclose && this.props.onClose();\n          action && action();\n        }\n      });\n    } else {\n      action && action();\n    }\n  };\n\n  onClose: VoidFunction = () => {\n    this.setState({ closing: true });\n    this.waitTransitionFinish((e?: TransitionEvent) => {\n      if (!e || e.propertyName === 'opacity') {\n        this.props.onClose();\n      }\n    });\n  };\n\n  stopPropagation: MouseEventHandler = (e: SyntheticEvent) => {\n    e.stopPropagation();\n  };\n\n  waitTransitionFinish(eventHandler: TransitionEndHandler) {\n    if (transitionEvent.supported) {\n      this.element.current.removeEventListener(transitionEvent.name, eventHandler);\n      this.element.current.addEventListener(transitionEvent.name, eventHandler);\n    } else {\n      clearTimeout(this.transitionFinishTimeout);\n      this.transitionFinishTimeout = setTimeout(eventHandler.bind(this), this.props.platform === ANDROID ? 200 : 300);\n    }\n  }\n\n  render() {\n    const { actions, actionsLayout, children, className, style, platform, ...restProps } = this.props;\n    const { closing } = this.state;\n\n    return (\n      <PopoutWrapper\n        className={className}\n        closing={closing}\n        style={style}\n        onClick={this.onClose}\n      >\n        <div\n          {...restProps}\n          ref={this.element}\n          onClick={this.stopPropagation}\n          className={classNames(getClassName('Alert', platform), {\n            'Alert--v': actionsLayout === 'vertical',\n            'Alert--h': actionsLayout === 'horizontal',\n            'Alert--closing': closing,\n          })}\n        >\n          <div className=\"Alert__content\">{children}</div>\n          <footer className=\"Alert__footer\">\n            {actions.map((action: AlertActionInterface, i: number) => {\n              return (\n                <Tappable\n                  Component=\"button\"\n                  className={classNames('Alert__btn', `Alert__btn--${action.mode}`)}\n                  onClick={this.onItemClick(action)}\n                  key={`alert-action-${i}`}\n                >\n                  <span dangerouslySetInnerHTML={{ __html: action.title }} />\n                </Tappable>\n              );\n            })}\n          </footer>\n        </div>\n      </PopoutWrapper>\n    );\n  }\n}\n\nexport default withPlatform(Alert);\n"],"file":"Alert.js"}